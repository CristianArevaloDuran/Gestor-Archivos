{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/crist/Downloads/Node/gestor-de-archivos-front/hooks/useGetFiles.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\n\r\nexport default function useGetFiles() {\r\n  const apiUrl = process.env.NEXT_PUBLIC_API_URL;\r\n  \r\n  const [files, setFiles] = useState([]);\r\n  const [loading, setLoading] = useState(true)\r\n\r\n  const getFiles = async () => {\r\n      try {\r\n        setLoading(true)\r\n        const res = await fetch(`${apiUrl}files`, {\r\n          method: 'GET',\r\n          headers: {\r\n            'Content-Type': 'application/json'\r\n          }\r\n        });\r\n        const data = await res.json();\r\n        setFiles(data);\r\n        setLoading(false)\r\n      } catch(err) {\r\n        console.log(err);\r\n      };\r\n  }\r\n  \r\n  useEffect(() => {\r\n    getFiles();\r\n  }, [])\r\n\r\n  return {files, loading}\r\n}"],"names":[],"mappings":";;;AAGiB;AAHjB;;;AAEe,SAAS;;IACtB,MAAM;IAEN,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE,EAAE;IACrC,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,MAAM,WAAW;QACb,IAAI;YACF,WAAW;YACX,MAAM,MAAM,MAAM,MAAM,GAAG,OAAO,KAAK,CAAC,EAAE;gBACxC,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;YACF;YACA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,SAAS;YACT,WAAW;QACb,EAAE,OAAM,KAAK;YACX,QAAQ,GAAG,CAAC;QACd;;IACJ;IAEA,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;iCAAE;YACR;QACF;gCAAG,EAAE;IAEL,OAAO;QAAC;QAAO;IAAO;AACxB;GA5BwB","debugId":null}},
    {"offset": {"line": 56, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/crist/Downloads/Node/gestor-de-archivos-front/hooks/useUploadFile.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { useState } from \"react\";\r\n\r\nexport default function useUploadFile() {\r\n    const apiUrl = process.env.NEXT_PUBLIC_API_URL;\r\n    const [progress, setProgress] = useState(0);\r\n\r\n    const handleUpload = async (file) => {\r\n        const formData = new FormData();\r\n        formData.append('file', file);\r\n        \r\n\r\n        try{\r\n            const res = await axios.post(`${apiUrl}upload`, formData, {\r\n                headers: { 'Content-Type': 'multipart/form-data' },\r\n                onUploadProgress: (progressEvent) => {\r\n                    const percent = Math.round((progressEvent.loaded * 100) / progressEvent.total);\r\n                    setProgress(percent);\r\n                }\r\n            })\r\n            \r\n            if (res.status === 200) {\r\n                setTimeout(()=> {\r\n                    setProgress(0);\r\n                }, 3000);\r\n                return res;\r\n            }\r\n        } catch (err) {\r\n            console.log(err.message);\r\n        }\r\n    };\r\n    return {handleUpload, progress};\r\n};"],"names":[],"mappings":";;;AAImB;AAJnB;AACA;;;;AAEe,SAAS;;IACpB,MAAM;IACN,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEzC,MAAM,eAAe,OAAO;QACxB,MAAM,WAAW,IAAI;QACrB,SAAS,MAAM,CAAC,QAAQ;QAGxB,IAAG;YACC,MAAM,MAAM,MAAM,wIAAA,CAAA,UAAK,CAAC,IAAI,CAAC,GAAG,OAAO,MAAM,CAAC,EAAE,UAAU;gBACtD,SAAS;oBAAE,gBAAgB;gBAAsB;gBACjD,kBAAkB,CAAC;oBACf,MAAM,UAAU,KAAK,KAAK,CAAC,AAAC,cAAc,MAAM,GAAG,MAAO,cAAc,KAAK;oBAC7E,YAAY;gBAChB;YACJ;YAEA,IAAI,IAAI,MAAM,KAAK,KAAK;gBACpB,WAAW;oBACP,YAAY;gBAChB,GAAG;gBACH,OAAO;YACX;QACJ,EAAE,OAAO,KAAK;YACV,QAAQ,GAAG,CAAC,IAAI,OAAO;QAC3B;IACJ;IACA,OAAO;QAAC;QAAc;IAAQ;AAClC;GA7BwB","debugId":null}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/crist/Downloads/Node/gestor-de-archivos-front/context/FilesContext.js"],"sourcesContent":["'use client';\r\nimport { useState, createContext, useContext, useRef, useEffect } from \"react\";\r\nimport useGetFiles from \"@/hooks/useGetFiles\";\r\nimport useUploadFile from \"@/hooks/useUploadFile\";\r\n\r\nconst FilesContext = createContext();\r\nconst apiUrl = process.env.NEXT_PUBLIC_API_URL;\r\n\r\nexport function FilesProvider({children}) {\r\n    const [contextFiles, setContextFiles] = useState([]);\r\n    const timeouts = useRef({});\r\n    const [contextLoader, setContextLoader] = useState(false)\r\n\r\n    //Get files\r\n    const {files, loading} = useGetFiles();\r\n\r\n    //Upload file\r\n    const {handleUpload, progress} = useUploadFile();\r\n\r\n    useEffect(()=> {\r\n        setContextFiles(files);\r\n    }, [files])\r\n\r\n    //Function to delete a file\r\n    const deleteFile = async (filename) => {\r\n        setContextLoader(true);\r\n        try {\r\n          const response = await fetch(`${apiUrl}delete/${filename}`, {\r\n            method: 'DELETE'\r\n          });\r\n          if (response.ok) {\r\n            setContextFiles(prev => prev.filter(d => d.fileName !== filename));\r\n            setContextLoader(false);\r\n          }\r\n        } catch(err) {\r\n            setContextLoader(false);\r\n            console.log(err.message);\r\n        }\r\n    };\r\n    \r\n    //Function to upload a file\r\n    const uploadFile = async (file) => {\r\n        const res = await handleUpload(file);\r\n        if(res.status === 200) {\r\n            setContextFiles(prev => [\r\n                ...prev, \r\n                {\r\n                    fileName: res.data.file.fileName,\r\n                    originalName: res.data.file.originalName,\r\n                    size: res.data.file.size,\r\n                    type: res.data.file.type,\r\n                    url: res.data.file.url,\r\n                    _id: res.data.file._id\r\n                }\r\n            ]);\r\n        }\r\n\r\n        return res;\r\n    };\r\n    \r\n\r\n    //Function for starting a new download\r\n    /*const getFiles = async () => {\r\n        \r\n        setDownloads(prev => [...prev,\r\n            {\r\n                id: file._id,\r\n                name: file.originalName,\r\n                progress: 0,\r\n                controller\r\n            }\r\n        ]);\r\n    };\r\n\r\n    //Function for updating progress\r\n    const updateProgress = (id, progress) => {\r\n        setDownloads(prev => \r\n            prev.map(d => d.id === id ? {...d, progress} : d)\r\n        );\r\n    };\r\n\r\n    //Function for cancelling download\r\n    const cancelDownload = (id) => {\r\n        timeouts.current[id] = setTimeout(() => {\r\n            setDownloads(prev => prev.filter(d => d.id !== id));\r\n            delete timeouts.current[id];\r\n        }, 2000);\r\n    };\r\n\r\n    //Function for deleting completed downloads\r\n    const completeDownload = (id) => {\r\n        timeouts.current[id] = setTimeout(() =>{\r\n            setDownloads(prev => prev.filter(d => d.id !== id));\r\n            delete timeouts.current[id];\r\n        },5000);\r\n    };\r\n    */\r\n\r\n    return (\r\n        <FilesContext.Provider value={{contextFiles, loading, deleteFile, uploadFile, progress, contextLoader}}>\r\n            {children}\r\n        </FilesContext.Provider>\r\n    );\r\n}\r\n\r\nexport const useFiles = () => useContext(FilesContext);"],"names":[],"mappings":";;;;AAMe;;AALf;AACA;AACA;;;AAHA;;;;AAKA,MAAM,6BAAe,CAAA,GAAA,6JAAA,CAAA,gBAAa,AAAD;AACjC,MAAM;AAEC,SAAS,cAAc,EAAC,QAAQ,EAAC;;IACpC,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE,EAAE;IACnD,MAAM,WAAW,CAAA,GAAA,6JAAA,CAAA,SAAM,AAAD,EAAE,CAAC;IACzB,MAAM,CAAC,eAAe,iBAAiB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEnD,WAAW;IACX,MAAM,EAAC,KAAK,EAAE,OAAO,EAAC,GAAG,CAAA,GAAA,uHAAA,CAAA,UAAW,AAAD;IAEnC,aAAa;IACb,MAAM,EAAC,YAAY,EAAE,QAAQ,EAAC,GAAG,CAAA,GAAA,yHAAA,CAAA,UAAa,AAAD;IAE7C,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;mCAAE;YACN,gBAAgB;QACpB;kCAAG;QAAC;KAAM;IAEV,2BAA2B;IAC3B,MAAM,aAAa,OAAO;QACtB,iBAAiB;QACjB,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,GAAG,OAAO,OAAO,EAAE,UAAU,EAAE;gBAC1D,QAAQ;YACV;YACA,IAAI,SAAS,EAAE,EAAE;gBACf,gBAAgB,CAAA,OAAQ,KAAK,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK;gBACxD,iBAAiB;YACnB;QACF,EAAE,OAAM,KAAK;YACT,iBAAiB;YACjB,QAAQ,GAAG,CAAC,IAAI,OAAO;QAC3B;IACJ;IAEA,2BAA2B;IAC3B,MAAM,aAAa,OAAO;QACtB,MAAM,MAAM,MAAM,aAAa;QAC/B,IAAG,IAAI,MAAM,KAAK,KAAK;YACnB,gBAAgB,CAAA,OAAQ;uBACjB;oBACH;wBACI,UAAU,IAAI,IAAI,CAAC,IAAI,CAAC,QAAQ;wBAChC,cAAc,IAAI,IAAI,CAAC,IAAI,CAAC,YAAY;wBACxC,MAAM,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI;wBACxB,MAAM,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI;wBACxB,KAAK,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG;wBACtB,KAAK,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG;oBAC1B;iBACH;QACL;QAEA,OAAO;IACX;IAGA,sCAAsC;IACtC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAkCA,GAEA,qBACI,6LAAC,aAAa,QAAQ;QAAC,OAAO;YAAC;YAAc;YAAS;YAAY;YAAY;YAAU;QAAa;kBAChG;;;;;;AAGb;GA/FgB;;QAMa,uHAAA,CAAA,UAAW;QAGH,yHAAA,CAAA,UAAa;;;KATlC;AAiGT,MAAM,WAAW;;IAAM,OAAA,CAAA,GAAA,6JAAA,CAAA,aAAU,AAAD,EAAE;AAAY;IAAxC","debugId":null}}]
}